<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="css/style.css">
<script src="js/jquery.min.js"> </script>
<script src="js/screenings.js"> </script>
<script src="js/strftime-min.js"> </script>
<script src="js/spin.min.js"> </script>
    
<script>

$(document).ready(function() {
var opts = {
  lines: 13, // The number of lines to draw
  length: 20, // The length of each line
  width: 10, // The line thickness
  radius: 30, // The radius of the inner circle
  corners: 1, // Corner roundness (0..1)
  rotate: 0, // The rotation offset
  direction: 1, // 1: clockwise, -1: counterclockwise
  color: '#000', // #rgb or #rrggbb or array of colors
  speed: 1, // Rounds per second
  trail: 60, // Afterglow percentage
  shadow: true, // Whether to render a shadow
  hwaccel: false, // Whether to use hardware acceleration
  className: 'spinner', // The CSS class to assign to the spinner
  zIndex: 2e9, // The z-index (defaults to 2000000000)
  top: 'auto', // Top position relative to parent in px
  left: 'auto' // Left position relative to parent in px
};
var target = document.getElementById("spinnerDiv");
var spinner = new Spinner(opts).spin(target);
});
    
$(document).ready(function(){
        var request=$.ajax({
              type: "GET",
              //url: "schedule_example.json",
              url: "http://2.cinema-sderot.appspot.com/getSimpleJson",
              dataType: "json",
              crossDomain: true
        });
        
        request.done(function( result ) {
            for (var i = 0; i < result.screenings.length; i++) {
                var screening      = result.screenings[i];
                var screeningDate  = screening.date;
                var movieId        = screening.movieId;
                
                var movie          = result.movies[movieId];
                var title          = movie.title;
                var duration       = movie.duration;
                var language       = movie.language;
                var year           = movie.year;
                var movieHour      = screeningDate.split('-')[3].replace('.',':');
                var description    = movie.description;
                if (i%2==0) {
                    screeningColorClass="screeningOdd";
                } else {
                    screeningColorClass="screeningEven";
                }
                
                var movieContainerDivId = createUniqueDivId(screeningDate, movieId); 
                var movieContainerDivIdSelector = "#"+movieContainerDivId.replace(".","\\\\.");
                
                titleH1      = "<h1>"+movieHour+" "+title+"</h1>"
                titleDiv     = "<div class=\"screeningTitle\">\n"+titleH1+"\n</div>";
                
                descriptionDiv = "<div class=\"movieDescription\">\n"+description+"\n</div>";
                
                metaDataDiv    = 
                    "<div class=\"metadataContainer\">\n"+
                        "<div class=\"duration metadata\">\n"+
                            duration+
                        "\n</div>"+
                        "<div class=\"language metadata\">\n"+
                            language+
                        "\n</div>"+
                        "<div class=\"year metadata\">\n"+
                            year+
                        "\n</div>"+
                    "\n</div>\n";
                
                movieInfoDiv = "<div class=\"movieInfo\">\n"+titleDiv+metaDataDiv+descriptionDiv+"\n</div>";
                imgDiv       = "<div class=\"movieImage\"><img width=\"100%\" src=\""+movie.image_url+"\"/></div>";
                clearDiv     = "\n<br class=\"clear\"/>";
                screeningDiv = "<div class=\"screening "+screeningColorClass+
                    "\" id=\""+movieContainerDivId+"\">\n"+movieInfoDiv+"\n"+imgDiv+clearDiv+"\n</div>";
                $("#screeningContainer").append(screeningDiv);
            }
            $("#spinnerDiv").remove();
        });
         
        request.fail(function( jqXHR, textStatus ) {
          $("div").append("Request failed: " + textStatus);
        });
    
        
        
});
    

</script>
</head>
<body>
<div id="spinnerDiv"></div>
<div id="screeningContainer">
    
</div>
</body>
</html>